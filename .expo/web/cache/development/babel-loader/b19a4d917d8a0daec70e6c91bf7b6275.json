{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nvar _jsxFileName = \"/Users/christopherkoch/reactnatchat/components/CustomActions.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\nimport * as Permissions from \"expo-permissions\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Location from \"expo-location\";\n\nvar CustomActions = function (_Component) {\n  _inherits(CustomActions, _Component);\n\n  function CustomActions(props) {\n    var _this;\n\n    _classCallCheck(this, CustomActions);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CustomActions).call(this, props));\n\n    _this.pickImage = function _callee() {\n      var _ref, status, result, imageUrl;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n            case 3:\n              _ref = _context.sent;\n              status = _ref.status;\n\n              if (!(status === \"granted\")) {\n                _context.next = 14;\n                break;\n              }\n\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.Images\n              }).catch(function (err) {\n                return console.log(err.message);\n              }));\n\n            case 8:\n              result = _context.sent;\n\n              if (result.cancelled) {\n                _context.next = 14;\n                break;\n              }\n\n              _context.next = 12;\n              return _regeneratorRuntime.awrap(_this.uploadImage(result.uri));\n\n            case 12:\n              imageUrl = _context.sent;\n\n              _this.props.onSend({\n                image: imageUrl\n              });\n\n            case 14:\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0.message);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 16]]);\n    };\n\n    _this.takePhoto = function _callee2() {\n      var _ref2, status, result, imageUrl;\n\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL, Permissions.CAMERA));\n\n            case 3:\n              _ref2 = _context2.sent;\n              status = _ref2.status;\n\n              if (!(status === \"granted\")) {\n                _context2.next = 14;\n                break;\n              }\n\n              _context2.next = 8;\n              return _regeneratorRuntime.awrap(ImagePicker.launchCameraAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.Images\n              }).catch(function (err) {\n                return console.log(err.message);\n              }));\n\n            case 8:\n              result = _context2.sent;\n\n              if (result.cancelled) {\n                _context2.next = 14;\n                break;\n              }\n\n              _context2.next = 12;\n              return _regeneratorRuntime.awrap(_this.uploadImage(result.uri));\n\n            case 12:\n              imageUrl = _context2.sent;\n\n              _this.props.onSend({\n                image: imageUrl\n              });\n\n            case 14:\n              _context2.next = 19;\n              break;\n\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0.message);\n\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[0, 16]]);\n    };\n\n    _this.getLocation = function _callee3() {\n      var _ref3, status, result;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n            case 3:\n              _ref3 = _context3.sent;\n              status = _ref3.status;\n\n              if (!(status === \"granted\")) {\n                _context3.next = 10;\n                break;\n              }\n\n              _context3.next = 8;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}).catch(console.log(err.message)));\n\n            case 8:\n              result = _context3.sent;\n\n              if (result) {\n                _this.props.onSend({\n                  location: {\n                    longitude: result.coords.longitude,\n                    latitude: result.coords.latitude\n                  }\n                });\n              }\n\n            case 10:\n              _context3.next = 15;\n              break;\n\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log(_context3.t0.message);\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, [[0, 12]]);\n    };\n\n    _this.uploadImage = function _callee4(uri) {\n      var blob, uriParts, imageName, ref, snapshot, imageUrl;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(new Promise(function (resolve, reject) {\n                var xhr = new XMLHttpRequest();\n\n                xhr.onload = function () {\n                  resolve(xhr.response);\n                };\n\n                xhr.onerror = function (err) {\n                  console.log(err);\n                  reject(new TypeError('Network request failed'));\n                };\n\n                xhr.responseType = 'blob';\n                xhr.open('GET', uri, true);\n                xhr.send(null);\n              }));\n\n            case 3:\n              blob = _context4.sent;\n              uriParts = uri.split('/');\n              imageName = uriParts[uriParts.length - 1];\n              ref = firebase.storage().ref().child(\"\" + imageName);\n              _context4.next = 9;\n              return _regeneratorRuntime.awrap(ref.put(blob));\n\n            case 9:\n              snapshot = _context4.sent;\n              blob.close();\n              _context4.next = 13;\n              return _regeneratorRuntime.awrap(snapshot.ref.getDownloadURL());\n\n            case 13:\n              imageUrl = _context4.sent;\n              return _context4.abrupt(\"return\", imageUrl);\n\n            case 17:\n              _context4.prev = 17;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.log(_context4.t0);\n\n            case 20:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, [[0, 17]]);\n    };\n\n    _this.onActionPress = function () {\n      var options = ['Choose Image from Library', 'Take Picture', 'Send Location', 'Cancel'];\n      var cancelButtonIndex = options.length - 1;\n\n      _this.context.actionSheet().showActionSheetWithOptions({\n        options: options,\n        cancelButtonIndex: cancelButtonIndex\n      }, function _callee5(buttonIndex) {\n        return _regeneratorRuntime.async(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.t0 = buttonIndex;\n                _context5.next = _context5.t0 === 0 ? 3 : _context5.t0 === 1 ? 4 : _context5.t0 === 2 ? 5 : _context5.t0 === 3 ? 6 : 7;\n                break;\n\n              case 3:\n                return _context5.abrupt(\"return\", _this.pickImage());\n\n              case 4:\n                return _context5.abrupt(\"return\", _this.takePhoto());\n\n              case 5:\n                return _context5.abrupt(\"return\", _this.getLocation());\n\n              case 6:\n                return _context5.abrupt(\"return\", null);\n\n              case 7:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(CustomActions, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(TouchableOpacity, {\n        style: styles.container,\n        onPress: this.onActionPress,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        }\n      }, React.createElement(View, {\n        style: [styles.wrapper, this.props.wrapperStyle],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        }\n      }, React.createElement(Text, {\n        style: [styles.iconText, this.props.iconTextStyle],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        }\n      }, \"+\")));\n    }\n  }]);\n\n  return CustomActions;\n}(Component);\n\nexport { CustomActions as default };\nvar styles = StyleSheet.create({\n  container: {\n    width: 26,\n    height: 26,\n    marginLeft: 10,\n    marginBottom: 10\n  },\n  wrapper: {\n    borderRadius: 13,\n    borderColor: \"#333\",\n    borderWidth: 2,\n    flex: 1\n  },\n  iconText: {\n    color: \"#333\",\n    fontWeight: \"bold\",\n    fontSize: 16,\n    backgroundColor: \"transparent\",\n    textAlign: \"center\"\n  }\n});\nCustomActions.contextTypes = {\n  actionSheet: PropTypes.func\n};","map":{"version":3,"sources":["/Users/christopherkoch/reactnatchat/components/CustomActions.js"],"names":["React","Component","PropTypes","firebase","Permissions","ImagePicker","Location","CustomActions","props","pickImage","askAsync","CAMERA_ROLL","status","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","catch","err","console","log","message","result","cancelled","uploadImage","uri","imageUrl","onSend","image","takePhoto","CAMERA","launchCameraAsync","getLocation","LOCATION","getCurrentPositionAsync","location","longitude","coords","latitude","Promise","resolve","reject","xhr","XMLHttpRequest","onload","response","onerror","TypeError","responseType","open","send","blob","uriParts","split","imageName","length","ref","storage","child","put","snapshot","close","getDownloadURL","onActionPress","options","cancelButtonIndex","context","actionSheet","showActionSheetWithOptions","buttonIndex","styles","container","wrapper","wrapperStyle","iconText","iconTextStyle","StyleSheet","create","width","height","marginLeft","marginBottom","borderRadius","borderColor","borderWidth","flex","color","fontWeight","fontSize","backgroundColor","textAlign","contextTypes","func"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { StyleSheet, Text, View, TouchableOpacity } from \"react-native\";\n\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\n\nimport * as Permissions from \"expo-permissions\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Location from \"expo-location\";\n\nexport default class CustomActions extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  pickImage = async () => {\n    try {\n      const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n      if (status === \"granted\") {\n        let result = await ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images\n        }).catch(err => console.log(err.message));\n        if (!result.cancelled) {\n          const imageUrl = await this.uploadImage(result.uri);\n          this.props.onSend({ image: imageUrl });\n        }\n      }\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  takePhoto = async () => {\n    try {\n      const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL, Permissions.CAMERA);\n      if (status === \"granted\") {\n        let result = await ImagePicker.launchCameraAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images\n        }).catch(err => console.log(err.message));\n        if (!result.cancelled) {\n          const imageUrl = await this.uploadImage(result.uri);\n          this.props.onSend({ image: imageUrl });\n        }\n      }\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  getLocation = async () => {\n    try {\n      const { status } = await Permissions.askAsync(Permissions.LOCATION);\n      if (status === \"granted\") {\n        let result = await Location.getCurrentPositionAsync({}).catch(\n          console.log(err.message)\n        );\n        if (result) {\n          this.props.onSend({\n            location: {\n              longitude: result.coords.longitude,\n              latitude: result.coords.latitude\n            }\n          });\n        }\n      }\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  uploadImage = async (uri) => {\n    try {\n      const blob = await new Promise((resolve, reject) => {\n        const xhr = new XMLHttpRequest();\n        xhr.onload = function () {\n          resolve(xhr.response);\n        };\n        xhr.onerror = function (err) {\n          console.log(err);\n          reject(new TypeError('Network request failed'));\n        };\n        xhr.responseType = 'blob';\n        xhr.open('GET', uri, true);\n        xhr.send(null);\n      });\n      let uriParts = uri.split('/');\n      let imageName = uriParts[uriParts.length - 1];\n      const ref = firebase.storage().ref().child(`${imageName}`);\n      const snapshot = await ref.put(blob);\n      blob.close();\n      const imageUrl = await snapshot.ref.getDownloadURL();\n      return imageUrl;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  onActionPress = () => {\n    const options = ['Choose Image from Library', 'Take Picture', 'Send Location', 'Cancel'];\n    const cancelButtonIndex = options.length - 1;\n    this.context.actionSheet().showActionSheetWithOptions(\n      {\n        options,\n        cancelButtonIndex\n      },\n      async (buttonIndex) => {\n        switch (buttonIndex) {\n          case 0:\n            return this.pickImage();\n          case 1:\n            return this.takePhoto();\n          case 2:\n            return this.getLocation();\n          case 3:\n            return null;\n          default:\n        }\n      }\n    );\n  }\n\n  render() {\n    return (\n      <TouchableOpacity\n        style={styles.container}\n        onPress={this.onActionPress}>\n        <View style={[styles.wrapper, this.props.wrapperStyle]}>\n          <Text style={[styles.iconText, this.props.iconTextStyle]}>+</Text>\n        </View>\n      </TouchableOpacity>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: 26,\n    height: 26,\n    marginLeft: 10,\n    marginBottom: 10\n  },\n  wrapper: {\n    borderRadius: 13,\n    borderColor: \"#333\",\n    borderWidth: 2,\n    flex: 1\n  },\n  iconText: {\n    color: \"#333\",\n    fontWeight: \"bold\",\n    fontSize: 16,\n    backgroundColor: \"transparent\",\n    textAlign: \"center\"\n  }\n});\n\nCustomActions.contextTypes = {\n  actionSheet: PropTypes.func\n};"]},"metadata":{},"sourceType":"module"}